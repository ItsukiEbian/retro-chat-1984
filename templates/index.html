<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Video Desk — ビデオ会議</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.4/socket.io.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body>
    <!-- Tap to Start Overlay (Mobile) -->
    <div id="overlay" class="overlay">
        <div class="overlay-card">
            <div class="overlay-card-header">
                <span class="overlay-icon">▶</span>
                <h1>ビデオを開始</h1>
                <p>カメラにアクセスしてミーティングを開始します</p>
            </div>
            <div class="overlay-card-actions">
                <button id="startBtn" class="btn-primary">開始する</button>
            </div>
        </div>
    </div>

    <!-- Left fixed sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <span class="logo-icon">◉</span>
                <span class="logo-text">Video Desk</span>
            </div>
        </div>
        <nav class="sidebar-nav">
            <a href="#" class="nav-item nav-item-active" data-view="meeting">
                <span class="nav-icon">📹</span>
                <span class="nav-label">ミーティング</span>
            </a>
            <button type="button" class="nav-item" id="sidebarShareBtn" aria-label="共有">
                <span class="nav-icon">🔗</span>
                <span class="nav-label">共有</span>
            </button>
            <button type="button" class="nav-item" id="sidebarSettingsBtn" aria-label="設定">
                <span class="nav-icon">⚙</span>
                <span class="nav-label">設定</span>
            </button>
        </nav>
        <div class="sidebar-footer">
            <div class="sidebar-room">
                <span class="sidebar-room-label">ルームID</span>
                <span class="sidebar-room-value" id="sidebarRoomId">—</span>
            </div>
        </div>
    </aside>

    <!-- Main content -->
    <main class="main">
        <header class="main-header">
            <div class="main-header-left">
                <h2 class="main-title">ミーティング</h2>
                <span class="room-badge" id="roomBadge">ルーム: <span id="headerRoomId">—</span></span>
            </div>
            <div class="main-header-actions">
                <button type="button" class="btn-secondary" id="qrBtn">QRコードで共有</button>
            </div>
        </header>

        <div class="main-content">
            <div class="card card-video">
                <div class="card-header">
                    <h3>ビデオ通話</h3>
                    <div id="status" class="status-text">待機中...</div>
                </div>
                <div class="card-body card-body-video">
                    <div class="videos-container" id="videosContainer">
                        <!-- Dynamic videos -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Right slide-out panel -->
    <div class="panel-backdrop" id="panelBackdrop" aria-hidden="true"></div>
    <aside class="panel panel-right" id="rightPanel" aria-label="設定パネル">
        <div class="panel-header">
            <h2 class="panel-title" id="panelTitle">共有</h2>
            <button type="button" class="panel-close" id="panelClose" aria-label="閉じる">&times;</button>
        </div>
        <div class="panel-content">
            <div class="panel-view panel-view-share" id="panelViewShare">
                <div class="share-section">
                    <p class="share-desc">このQRコードをスキャンしてルームに参加</p>
                    <div id="qrcode" class="qrcode-wrap"></div>
                    <p id="roomUrl" class="room-url"></p>
                    <button type="button" class="btn-secondary btn-copy" id="copyUrlBtn">URLをコピー</button>
                </div>
            </div>
            <div class="panel-view panel-view-settings" id="panelViewSettings" hidden>
                <div class="settings-section">
                    <h4>設定</h4>
                    <p class="settings-desc">オーディオ・ビデオ設定は今後追加予定です。</p>
                </div>
            </div>
        </div>
    </aside>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

</html>
